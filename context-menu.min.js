var dynamicMenu="context-menu-dynamic";var cancelClose=false;(function(e,t){e.fn.contextMenu=function(n){function r(r){var i=r.pageX;var s=e(t).width();var o=e(n.menuSelector).width();if(i+o>s&&o<i){return i-o}return i}function i(r){var i=r.pageY;var s=e(t).height();var o=e(n.menuSelector).height();if(i+o>s&&o<i){return i-o}return i}return this.each(function(){e(this).on("contextmenu",function(t){if(n.hasOwnProperty("menuObject")){var s=n.menuObject;if(e("#"+dynamicMenu).length==0){child=e(createMenuHTML(dynamicMenu,s)).appendTo("body");n.menuSelector=child}else{n.menuSelector=e("#"+dynamicMenu)}}e(n.menuSelector).data("invokedOn",e(t.target)).show().css({position:"absolute",left:r(t),top:i(t)}).off("click").on("click",function(t){var r=e(this).data("invokedOn");var i=e(t.target);if(i.closest("li").hasClass("dropdown-submenu")){cancelClose=true;return}if(e(this).attr("id")!=dynamicMenu){e(this).hide()}n.menuSelected.call(this,r,i);if(e(this).attr("id")==dynamicMenu){e(this).remove()}});return false});e(document).click(function(){if(cancelClose){cancelClose=false;return}var t=e(n.menuSelector);if(t.attr("id")==dynamicMenu){t.remove()}else{t.hide()}})})}})(jQuery,window);var createMenuHTML=function(e,t){var n="<ul";if(e!="")n+=' id="'+e+'" class="dropdown-menu" role="menu" style="display:none">';else n+=' class="dropdown-menu">';$(t).each(function(e,t){if(t.hasOwnProperty("name")){if(t.hasOwnProperty("subMenu")){n+='<li class="dropdown-submenu">';n+='<a id="subMenuItem" tabindex="-1" href="#">';if(t.hasOwnProperty("icon"))n+='<span class="glyphicon '+t.icon+'"></span> ';n+=t.title;n+="</a>";n+=createMenuHTML("",t.subMenu);n+="</li>"}else{n+='<li><a id="'+t.name+'" tabindex="-1" href="#">';if(t.hasOwnProperty("icon"))n+='<span class="glyphicon '+t.icon+'"></span> ';n+=t.title;n+="</a></li>"}}else{n+='<li class="divider"></li>'}});n+="</ul>";return n}
